t <- c(2586,2521,2547,2255,315,495,2088,2489,2643,2673,2266,429,532,1768,2552,2665,2834,2474,397,539,2492,2708,2836,3075,2516,405,530,2536,2794,2973,3002,2375,459,555,2329,2438,3006,3033,2577,412,656,2875,3057,2713,2843,2355,383,519,2629,2744,2819,2826,2455,464,535,2464,3114,3314,3314,2809,434,615,2864,3351,3294,3549,3025,363,583,2812,3081,3227,3338,2695,382,619,2690,3136,3163,3399,2689,522,597,2735,3162,3201,3096,3447,460,646,3173,3111,3612,3415,3229,511,661,2890,3030,2908,2323,2036,414,542,2721,2878,2866,3082,2506,428,579,2635,3002,2958,3014,2626,420,569,2631,2664,2910,3007,2496,414,426,2141,1392,375,1146,1504,338,414,1730,1393,407,1743,1863,397,507,2264,2619,2669,2939,2564,433,606,2730,2946,3049,3295,2581,567,575,2687,3137,3371,2801,3074,446,499,2805,3122,3165,3245,2985,446,609,2879,3032,3128,3057,2756,461,461,2528,2768,3126,3183,2883,461,545,2096,3082,3161,3309,2831,368,576,2946,3139,3138,3260,3135,530,615,2888,3231,2788,2966,2690,484,551,2693,2954,3297,3438,3005,480,603,2965,3041,3176,3177,3008,490,548,2755,3025,3107,2699,1106,428,428,1952,2839,2953,2884,2458,473,550,2692,2947,2952,3241,2653,420,595,2935,3540,3578,3797,3067,397,542,3301,3638,3728,3857,3406,413,597,3215,3553,3623,2368,2788,263,677,2666,3426,3335,2981,2699,401,564,3067,3356,3674,3928,3745,429,547,3097,3645,3794,3902,3968,446,613,2511,3396,3398,2915,3065,453,661,3069,3117,3127,3251,2902,405,594,2748,3275,3251,3248,3011,429,606,2752,3498,2929,3262,3081,465,563,2844,2992,3143,3251,2863,389,521,2807,2928,3051,2818,1956,337,485,2665,2925,3052,3179,2764,363,523,2811,3272,3504,3428,2831,382,472,2831,3426,3636,3715,2868,199,318,2976,3182,3267,3385,2779,339,434,2869,3064,3093,3084,2683,214,428,2394,2744,2975,3072,2570,347,459,2792,3008)
x <- c(14,20,21,15,12,9,15,19,30,29,22,49,59,105,441,301,164,120,41,64,95,86,108,178,133,43,60,99,68,66,58,27,10,13,30,20,27,26,11,2,8,23,42,23,21,14,3,13,26,21,18,20,12,4,18,43,39,38,24,19,13,17,22,27,21,30,12,6,9,12,18,13,30,20,5,13,23,13,15,21,12,8,11,23,28,25,15,15,7,11,10,10,20,9,14,6,9,56,49,59,33,23,10,10,34,37,29,39,46,17,23,62,75,56,45,32,13,17,47,33,26,46,43,6,12,19,20,11,9,19,9,10,21,18,9,18,8,5,9,28,28,36,22,16,6,13,21,21,24,18,18,13,12,13,21,18,11,23,2,8,13,13,34,39,12,7,10,13,25,14,13,15,4,2,9,18,18,19,12,6,8,14,19,15,21,12,6,7,19,18,30,26,24,6,5,25,18,26,18,14,5,7,12,20,16,27,13,5,8,17,15,19,16,21,2,10,17,21,14,21,6,6,11,9,11,18,17,12,6,5,15,12,16,19,20,7,10,19,11,13,11,17,1,3,30,32,15,40,36,4,7,10,9,17,19,7,2,10,11,20,18,15,14,9,5,16,14,27,21,18,14,11,26,23,26,50,15,8,14,21,23,21,17,17,7,9,25,41,46,36,18,4,11,27,33,31,26,20,9,14,28,29,28,27,25,11,17,46,52,32,31,17,7,10,18,22,11,21,13,5,4,16,36,34,19,26,8,11,33,22,24,29,16,2,7,36,33,22,13,16,2,3,33,21,26,29,21,4,10,38,35,38,45,42,1,11,42,27,28,19,13,5,4,22,23)
  
N <- sum(t)
df <- sum(x)

plot(t, type="l")
dfidf = (x/t) * (log(N/df))
plot(dfidf, type="l")
p <- periodogram(dfidf, plot=T)
length(dfidf)/which(p$spec == max(p$spec))
which(p$spec == max(p$spec))
max(p$spec)
  p

y <- c(1.1328465969074255,1.6031207304135333,0.8881348553035868,1.6734330431509687,0.0,0.0,0.0,0.0,0.9242798784845466,0.8069854776616348,43.91417975121011,12.661816388443171,10.839282211318775,8.868503627442635,10.436070400394444,6.474141411285422,3.572497507850383,6.037068573392736,5.368800194724496,2.704698018703362,8.432918969906158,5.322861800201184,5.020299129452907,3.2297635482936307,2.2029026203142084,0.8998649382981625,6.114466888436231,4.9473902209338805,6.827196157640455,2.0251737464884334,6.38743416024142,3.51544287934663,0.0,2.167856442263755,3.090248924177275,1.2995324722017059,5.106299971070944,0.9654421402794051,3.2116391737240813,5.309036185135726,1.8739819933124797,2.950072684317687,1.9269835042344488,0.0,0.9171700332654348,0.9753137368057795,1.9872017387417753,3.4643710699614485,4.359491931426199,2.0039009130169165,1.954624661057484,0.0,2.838859626773965)
plot(y, type="l")
y <- y*100
z <- c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.008132859141174554, 0.01534114061156295, 0.0328986085349544, 0.03365839164199723, 0.0, 0.14792072010614918, 0.27968936332802785, 0.13411733356734482, 0.1160356973008344, 0.146391464541142, 0.1432342366681553, 0.07835528806981076, 0.08280729307377728, 0.05508562908579569, 0.12906204806049212, 0.05461380356900086, 0.09588212882226843, 0.07360648273224647, 0.17575425468720077, 0.22906221738286522, 0.12771104168904207, 0.08096713100547112, 0.11980629636206074, 0.04904739666677578, 0.014901925951927202, 0.0, 0.0, 0.0066609157134299825, 0.0, 0.0074662313427176245, 0.0, 0.0)
lines(z, col="red", type="l")


y <- dfidf*100
z <- rep(1:length(y), y)
library(mixtools)
nmix <- normalmixEM(z, k=2, ECM=F)
plot(nmix, which=2)
lambda <- which(nmix$lambda == max(nmix$lambda))
mu <- nmix$mu[lambda]
sigma <- nmix$sigma[lambda]
abline(v=mu+2*sigma)
abline(v=mu-2*sigma)

t <- c(421,595,537,570,575,557,563,530,516,591,467,452,484,484,457,442,534,474,533,529,509,448,475,443,433,530,468,482,489,471,448,407,465,440,463,367,467,494,594,539,509,485,495,517,520,489,480,413,547,476,488,358,168)
x <- y

N <- sum(t)
df <- sum(x)

dfidf = (x/t) * (log(N/df))
plot(dfidf, type="l")
p <- periodogram(dfidf, plot=T)
length(dfidf)/which(p$spec == max(p$spec))
which(p$spec == max(p$spec))
max(p$spec)
p

dfidf <- dfidf*100
library(MASS)
z <- rep(1:length(dfidf), dfidf)
plot(x, type="l")

fitdistr(z, "normal")
hist(z, type="l", breaks=100)
plot(density(z))
n <- dnorm(z, 17.8280872, 16.0505251)
plot(z, n, type="l")

